
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Expression Types &#8212; JMESPath</title>
    <link rel="stylesheet" href="../_static/jmespath.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Improved Filters" href="jep-009-improved-filters.html" />
    <link rel="prev" title="Filter Expressions" href="jep-007-filter-expressions.html" />
  
   

  </head><body>
<nav class="navbar navbar-inverse navbar-static-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#toggle-main-nav">
      </button>
      <a class="navbar-brand" href="../contents.html"></a>
    </div>
    <div class="collapse navbar-collapse" id="toggle-main-nav">
      <ul class="nav navbar-nav">
        <li><a href="../index.html">Home</a></li>
        <li><a href="../tutorial.html">Tutorial</a></li>
        <li><a href="../examples.html">Examples</a></li>
        <li><a href="../specification.html">Specification</a></li>
        <li><a href="../libraries.html">Libraries</a></li>
        <li><a href="https://github.com/jmespath-community">Github</a></li>
      </ul>
    </div>
  </div>
</nav>


    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="jep-009-improved-filters.html" title="Improved Filters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="jep-007-filter-expressions.html" title="Filter Expressions"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">JMESPath</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../proposals.html" accesskey="U">JMESPath Proposals</a> &#187;</li> 
      </ul>
    </div>
        <div class="container">
            <div class="main-content">
              <div class="row">
                  <div class="col-md-9 col-md-push-3">
                    
  <div class="section" id="expression-types">
<h1>Expression Types<a class="headerlink" href="#expression-types" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">JEP:</th><td class="field-body">8</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">James Saryerwinnie</td>
</tr>
<tr class="field-odd field"><th class="field-name">Status:</th><td class="field-body">accepted</td>
</tr>
<tr class="field-even field"><th class="field-name">Created:</th><td class="field-body">02-Mar-2013</td>
</tr>
</tbody>
</table>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This JEP proposes grammar modifications to JMESPath to allow for
expression references within functions.  This allows for functions
such as <code class="docutils literal notranslate"><span class="pre">sort_by</span></code>, <code class="docutils literal notranslate"><span class="pre">max_by</span></code>, <code class="docutils literal notranslate"><span class="pre">min_by</span></code>.  These functions take
an argument that resolves to an expression type.  This enables
functionality such as sorting an array based on an expression that
is evaluated against every array element.</p>
</div>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>A useful feature that is common in other expression languages is the
ability to sort a JSON object based on a particular key.  For example,
given a JSON object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;people&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;age_str&quot;</span><span class="p">:</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;age_str&quot;</span><span class="p">:</span> <span class="s2">&quot;40&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;extra&quot;</span><span class="p">:</span> <span class="s2">&quot;bar&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;age_str&quot;</span><span class="p">:</span> <span class="s2">&quot;30&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;c&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;age_str&quot;</span><span class="p">:</span> <span class="s2">&quot;50&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;d&quot;</span><span class="p">},</span>
       <span class="p">{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;age_str&quot;</span><span class="p">:</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is not currently possible to sort the <code class="docutils literal notranslate"><span class="pre">people</span></code> array by the <code class="docutils literal notranslate"><span class="pre">age</span></code> key.
Also, <code class="docutils literal notranslate"><span class="pre">sort</span></code> is not defined for the <code class="docutils literal notranslate"><span class="pre">object</span></code> type, so it’s not currently
possible to even sort the <code class="docutils literal notranslate"><span class="pre">people</span></code> array.  In order to sort the <code class="docutils literal notranslate"><span class="pre">people</span></code>
array, we need to know what key to use when sorting the array.</p>
<p>This concept of sorting based on a key can be generalized.  Instead of
requiring a key name, an expression can be provided that each element
would be evaluated against.  In the simplest case, this expression would just
be an <code class="docutils literal notranslate"><span class="pre">identifier</span></code>, but more complex expressions could be used such as
<code class="docutils literal notranslate"><span class="pre">foo.bar.baz</span></code>.</p>
<p>A simple way to accomplish this might be to create a function like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">array</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">expression</span><span class="p">)</span>

<span class="c1"># Called like:</span>

<span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
<span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="n">to_number</span><span class="p">(</span><span class="n">age_str</span><span class="p">))</span>
</pre></div>
</div>
<p>However, there’s a problem with the <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> function as defined above.
If we follow the function argument resolution process we get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>

<span class="c1"># 1. resolve people</span>
<span class="n">arg1</span> <span class="o">=</span> <span class="n">search</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">data</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">},</span> <span class="p">{</span><span class="o">...</span><span class="p">}]</span>

<span class="c1"># 2. resolve age</span>
<span class="n">arg2</span> <span class="o">=</span> <span class="n">search</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">data</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">null</span>

<span class="n">sort_by</span><span class="p">([{</span><span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="o">...</span><span class="p">},</span> <span class="p">{</span><span class="o">...</span><span class="p">}],</span> <span class="n">null</span><span class="p">)</span>
</pre></div>
</div>
<p>The second argument is evaluated against the current node and the expression
<code class="docutils literal notranslate"><span class="pre">age</span></code> will resolve to <code class="docutils literal notranslate"><span class="pre">null</span></code> because the input data has no <code class="docutils literal notranslate"><span class="pre">age</span></code> key.
There needs to be some way to specify that an expression should evaluate to
an expression type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">arg</span> <span class="o">=</span> <span class="n">search</span><span class="p">(</span><span class="o">&lt;</span><span class="n">some</span> <span class="n">expression</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="nb">input</span> <span class="n">data</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">&lt;</span><span class="n">expression</span><span class="p">:</span> <span class="n">age</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Then the function definition of <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">array</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">expression</span> <span class="n">arg2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="specification">
<h2>Specification<a class="headerlink" href="#specification" title="Permalink to this headline">¶</a></h2>
<p>The following grammar rules will be updated to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span><span class="o">-</span><span class="n">arg</span>        <span class="o">=</span> <span class="n">expression</span> <span class="o">/</span>
                      <span class="n">current</span><span class="o">-</span><span class="n">node</span> <span class="o">/</span>
                      <span class="s2">&quot;&amp;&quot;</span> <span class="n">expression</span>
</pre></div>
</div>
<p>Evaluating an expression reference should return an object of type
“expression”.  The list of data types supported by a function will now be:</p>
<ul class="simple">
<li>number (integers and double-precision floating-point format in JSON)</li>
<li>string</li>
<li>boolean (<code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>)</li>
<li>array (an ordered, sequence of values)</li>
<li>object (an unordered collection of key value pairs)</li>
<li>null</li>
<li>expression (denoted by <code class="docutils literal notranslate"><span class="pre">&amp;expression</span></code>)</li>
</ul>
<p>Function signatures can now be specified using this new <code class="docutils literal notranslate"><span class="pre">expression</span></code> type.
Additionally, a function signature can specify the return type of the
expression.  Similarly how arrays can specify a type within a list using the
<code class="docutils literal notranslate"><span class="pre">array[type]</span></code> syntax, expressions can specify their resolved type using
<code class="docutils literal notranslate"><span class="pre">expression-&gt;type</span></code> syntax.</p>
<p>Note that any valid expression is allowed after <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>, so the following
expressions are valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">baz</span><span class="p">)</span>
<span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">foo</span><span class="o">.</span><span class="n">bar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">baz</span><span class="p">)</span>
<span class="n">sort_by</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">to_number</span><span class="p">(</span><span class="n">foo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="additional-functions">
<h3>Additional Functions<a class="headerlink" href="#additional-functions" title="Permalink to this headline">¶</a></h3>
<p>The following functions will be added:</p>
<div class="section" id="sort-by">
<h4>sort_by<a class="headerlink" href="#sort-by" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">array</span> <span class="n">elements</span><span class="p">,</span> <span class="n">expression</span><span class="o">-&gt;</span><span class="n">number</span><span class="o">|</span><span class="n">expression</span><span class="o">-&gt;</span><span class="n">string</span> <span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
<p>Sort an array using an expression <code class="docutils literal notranslate"><span class="pre">expr</span></code> as the sort key.
Below are several examples using the <code class="docutils literal notranslate"><span class="pre">people</span></code> array (defined above) as the
given input.  <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> follows the same sorting logic as the <code class="docutils literal notranslate"><span class="pre">sort</span></code>
function.</p>
<table border="1" class="docutils" id="id1">
<caption><span class="caption-text">Examples</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">sort_by(people,</span> <span class="pre">&amp;age)[].age</span></code></td>
<td>[10, 20, 30, 40, 50]</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">sort_by(people,</span> <span class="pre">&amp;age)[0]</span></code></td>
<td>{“age”: 10, “age_str”: “10”, “bool”: true, “name”: 3}</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">sort_by(people,</span> <span class="pre">&amp;to_number(age_str))[0]</span></code></td>
<td>{“age”: 10, “age_str”: “10”, “bool”: true, “name”: 3}</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="max-by">
<h4>max_by<a class="headerlink" href="#max-by" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">max_by</span><span class="p">(</span><span class="n">array</span> <span class="n">elements</span><span class="p">,</span> <span class="n">expression</span><span class="o">-&gt;</span><span class="n">number</span> <span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the maximum element in an array using the expression <code class="docutils literal notranslate"><span class="pre">expr</span></code> as the
comparison key.  The entire maximum element is returned.
Below are several examples using the <code class="docutils literal notranslate"><span class="pre">people</span></code> array (defined above) as the
given input.</p>
<table border="1" class="docutils" id="id2">
<caption><span class="caption-text">Examples</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">max_by(people,</span> <span class="pre">&amp;age)</span></code></td>
<td>{“age”: 50, “age_str”: “50”, “bool”: false, “name”: “d”},</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">max_by(people,</span> <span class="pre">&amp;age).age</span></code></td>
<td>50</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">max_by(people,</span> <span class="pre">&amp;to_number(age_str))</span></code></td>
<td>{“age”: 50, “age_str”: “50”, “bool”: false, “name”: “d”},</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">max_by(people,</span> <span class="pre">&amp;age_str)</span></code></td>
<td>&lt;error: invalid-type&gt;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">max_by(people,</span> <span class="pre">age)</span></code></td>
<td>&lt;error: invalid-type&gt;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="min-by">
<h4>min_by<a class="headerlink" href="#min-by" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_by</span><span class="p">(</span><span class="n">array</span> <span class="n">elements</span><span class="p">,</span> <span class="n">expression</span><span class="o">-&gt;</span><span class="n">number</span> <span class="n">expr</span><span class="p">)</span>
</pre></div>
</div>
<p>Return the minimum element in an array using the expression <code class="docutils literal notranslate"><span class="pre">expr</span></code> as the
comparison key.  The entire maximum element is returned.
Below are several examples using the <code class="docutils literal notranslate"><span class="pre">people</span></code> array (defined above) as the
given input.</p>
<table border="1" class="docutils" id="id3">
<caption><span class="caption-text">Examples</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Expression</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">min_by(people,</span> <span class="pre">&amp;age)</span></code></td>
<td>{“age”: 10, “age_str”: “10”, “bool”: true, “name”: 3}</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">min_by(people,</span> <span class="pre">&amp;age).age</span></code></td>
<td>10</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">min_by(people,</span> <span class="pre">&amp;to_number(age_str))</span></code></td>
<td>{“age”: 10, “age_str”: “10”, “bool”: true, “name”: 3}</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">min_by(people,</span> <span class="pre">&amp;age_str)</span></code></td>
<td>&lt;error: invalid-type&gt;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">min_by(people,</span> <span class="pre">age)</span></code></td>
<td>&lt;error: invalid-type&gt;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="alternatives">
<h3>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this headline">¶</a></h3>
<p>There were a number of alternative proposals considered.  Below outlines
several of these alternatives.</p>
<div class="section" id="logic-in-argument-resolver">
<h4>Logic in Argument Resolver<a class="headerlink" href="#logic-in-argument-resolver" title="Permalink to this headline">¶</a></h4>
<p>The first proposed choice (which was originally in JEP-3 but later removed) was
to not have any syntactic construct for specifying functions, and to allow the
function signature to dictate whether or not an argument was resolved.  The
signature for <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sort_by</span><span class="p">(</span><span class="n">array</span> <span class="n">arg1</span><span class="p">,</span> <span class="nb">any</span> <span class="n">arg2</span><span class="p">)</span>
<span class="n">arg1</span> <span class="o">-&gt;</span> <span class="n">resolved</span>
<span class="n">arg2</span> <span class="o">-&gt;</span> <span class="ow">not</span> <span class="n">resolved</span>
</pre></div>
</div>
<p>Then the argument resolver would introspect the argument specification of a
function to determine what to do.  Roughly speaking, the pseudocode would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">call</span><span class="o">-</span><span class="n">function</span><span class="p">(</span><span class="n">current</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
<span class="n">arglist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">each</span> <span class="n">argspec</span> <span class="ow">in</span> <span class="n">functions</span><span class="o">-</span><span class="n">argspec</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">argspect</span><span class="o">.</span><span class="n">should_resolve</span><span class="p">:</span>
      <span class="n">arglist</span> <span class="o">&lt;-</span> <span class="n">resolve</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">current</span><span class="o">-</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span>
      <span class="n">arglist</span> <span class="o">&lt;-</span> <span class="n">argument</span>
<span class="nb">type</span><span class="o">-</span><span class="n">check</span><span class="p">(</span><span class="n">arglist</span><span class="p">)</span>
<span class="k">return</span> <span class="n">invoke</span><span class="o">-</span><span class="n">function</span><span class="p">(</span><span class="n">arglist</span><span class="p">)</span>
</pre></div>
</div>
<p>However, there are several reasons not to do this:</p>
<ul class="simple">
<li>This imposes a specific implementation.  This implementation would be
challenging in a bytecode VM, as the CALL bytecode will typically
resolve arguments onto the stack and allow the function to then
pop arguments off the stack and perform its own arity validation.</li>
<li>This deviates from the “standard” model of how functions are
traditionally implemented.</li>
</ul>
</div>
<div class="section" id="specifying-expressions-as-strings">
<h4>Specifying Expressions as Strings<a class="headerlink" href="#specifying-expressions-as-strings" title="Permalink to this headline">¶</a></h4>
<p>Another proposed alternative was to allow the expression to be
a string type and to give functions the capability to parse/eval
expressions.  The <code class="docutils literal notranslate"><span class="pre">sort_by</span></code> function would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>sort_by(people, `age`)
sort_by(people, `foo.bar.baz`)
</pre></div>
</div>
<p>The main reasons this proposal was not chosen was because:</p>
<ul class="simple">
<li>This complicates the implementations.  For implementations that walk the AST
inline, this means AST nodes need access to the parser.  For external tree
visitors, the visitor needs access to the parser.</li>
<li>This moves what <em>could</em> by a compile time error into a run time error.  The
evaluation of the expression string happens when the function is invoked.</li>
</ul>
</div>
</div>
</div>
</div>


                  </div>
  <div class="col-md-3 col-md-pull-9 sphinxsidebar">
    <div class="sphinxsidebarwrapper"><p class="logo"><a href="/">
  <img id="sidebar-logo" src="../_static/img/logo-dark.png" alt="JMESPath Logo" />
</a></p>
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Expression Types</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#motivation">Motivation</a></li>
<li><a class="reference internal" href="#specification">Specification</a><ul>
<li><a class="reference internal" href="#additional-functions">Additional Functions</a><ul>
<li><a class="reference internal" href="#sort-by">sort_by</a></li>
<li><a class="reference internal" href="#max-by">max_by</a></li>
<li><a class="reference internal" href="#min-by">min_by</a></li>
</ul>
</li>
<li><a class="reference internal" href="#alternatives">Alternatives</a><ul>
<li><a class="reference internal" href="#logic-in-argument-resolver">Logic in Argument Resolver</a></li>
<li><a class="reference internal" href="#specifying-expressions-as-strings">Specifying Expressions as Strings</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

    </div>
  </div>
              </div>
            </div>

        </div>

<script>
$(document).ready(function() {
    $('.jmespath-demo').each(function(i, el) {
        function evaluateDemo(el) {
            var expression = $(el).find('.jmespath-expression').val();
            var inputData = JSON.parse($(el).find('.jmespath-input').val());
            var result = jmespath.search(inputData, expression);
            $(el).find('.jmespath-result').text(JSON.stringify(result, null, 2));
        }
        $(el).find('.jmespath-expression').bind('keyup', function() {
            evaluateDemo(el);
        });
        $(el).find('.jmespath-input').bind('keyup', function() {
            evaluateDemo(el);
        });
        evaluateDemo(el);
    });
    $('.jmespath-form').submit(function() {
      return false;
    });

    $('.collapse').on('shown.bs.collapse', function() {
        $(this).parent().find(".glyphicon-chevron-right").removeClass(
            "glyphicon-chevron-right").addClass("glyphicon-chevron-down");
    }).on('hidden.bs.collapse', function(){
        $(this).parent().find(".glyphicon-chevron-down").removeClass(
            "glyphicon-chevron-down").addClass("glyphicon-chevron-right");
    });

})
</script>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="jep-009-improved-filters.html" title="Improved Filters"
             >next</a> |</li>
        <li class="right" >
          <a href="jep-007-filter-expressions.html" title="Filter Expressions"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">JMESPath</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../proposals.html" >JMESPath Proposals</a> &#187;</li> 
      </ul>
    </div>

  <script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <script type="text/javascript" src="../_static/js/jmespath.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery-migrate-1.2.1.min.js"></script>
  <script src="//static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">try{ clicky.init(100732121); }catch(e){}</script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100732121ns.gif" /></p></noscript>
  <div class="footer container">
    &copy; Copyright 2014-2015, James Saryerwinnie.
  </div>
  </body>
</html>